Version
=======
> solidity-coverage: v0.7.17

Instrumenting for coverage...
=============================

> INFTPotion.sol
> INFTPotionValidator.sol
> INFTPotionWhitelist.sol
> NFTPotionAuction.sol
> RarityConfigItem.sol
> utils/StructuredLinkedList.sol

Coverage skipped for:
=====================

> NFTPotion.sol
> NFTPotionValidator.sol

Compilation:
============

Compiling 21 files with 0.8.9
Warning: Contract code size exceeds 24576 bytes (a limit introduced in Spurious Dragon). This contract may not be deployable on mainnet. Consider enabling the optimizer (with a low "runs" value!), turning off revert strings, or using libraries.
  --> contracts/NFTPotionAuction.sol:13:1:
   |
13 | contract NFTPotionAuction is Ownable, INFTPotionWhitelist, IStructureInterface {
   | ^ (Relevant source part starts here and spans across multiple lines).


Compilation finished successfully

Network Info
============
> HardhatEVM: v2.6.6
> network:    hardhat



  NFTPotionAuction
    Negative Cases
      Start Batch
        ✓ Start batch when another batch is started (113ms)
        ✓ Start batch with end date in the past
        ✓ Start batch with incorrect start token ID (513ms)
        ✓ Start batch with direct price less than minimum price
      Set Bid
        ✓ Call when batch is not active (77ms)
        ✓ Call with price less than minimum (53ms)
        ✓ Call with price higher or equal than purchase price (48ms)
        ✓ Send amount of cash different than needed (137ms)
      Cancel Bid
        ✓ Call when batch is not active (66ms)
      Purchase
        ✓ Call when batch is not active (67ms)
        ✓ Call with more tokens that are auctioned
        ✓ Call with more tokens that are auctioned
        ✓ Purchase some and call with more tokens that are left (335ms)
        ✓ Send less cash that needed (100ms)
      End Batch
        ✓ End batch when no batch is started (71ms)
        ✓ End batch before end date
      Claim
        ✓ Call before the batch is started (84ms)
        ✓ Call when bidder has no active bids (140ms)
      Claim Refund
        ✓ Call when refundable cash is 0 (66ms)
      Whitelist Bidders
        ✓ Call from non-owner account (96ms)
        ✓ Call when batch is active (91ms)
        ✓ Call with different length for input arrays (43ms)
        ✓ Call with gaps or overlaps in token IDs list (65ms)
      Transfer Funds
        ✓ Call with non-owner account (96ms)
      Pagination
        ✓ Set a bid between paginated endBatch (2024ms)
        ✓ Cancel a bid between paginated endBatch (1997ms)
        ✓ Claim a bid between paginated endBatch (2146ms)
        ✓ Call with bids to process equal to 0 (1888ms)

  NFTPotionAuction
    Auction Basic Cases
      ✓ Bidder rebids several times (994ms)
      ✓ Bidder bids and cancels repeated times, no refund (1179ms)
      ✓ Bidder bids and cancels repeated times, with refund (1080ms)
      ✓ Bidder bids and cancels repeated times, sometimes with refund (1607ms)
      ✓ Bidder purchase some tokens once (192ms)
      ✓ Bidder purchase some tokens several times (464ms)
      ✓ Bidder purchase all tokens at once (189ms)
      ✓ Bidder purchase all tokens in several purchases (853ms)

  NFTPotionAuction
    Auction Full Cycle
      Simple
        ✓ 1 Batch, 20 bidders, 100 token IDs (5029ms)
        ✓ 2 Batches, 20 bidders, 10 token IDs, then 100 token IDs (9004ms)
      Purchase
        ✓ 1 Batch, 20 tokens, 1 bidder purchases 5 tokens (267ms)
        ✓ 1 Batch, 20 tokens, 3 bidders purchase 7,2,3 tokens each (484ms)
        ✓ 1 Batch, 100 tokens, 10 bidders purchase 1 to 6 tokens each (505ms)
      Auction + Purchase
        ✓ 1 Batch, 129 tokens, 12 bidders, 5 purchasers (4412ms)
      Cancel Bid
        ✓ 1 Batch, 876 tokens, previous bid is cancelled before new bid is mined (9199ms)
        ✓ 1 Batch, 18 tokens, previous 10 bids are cancelled before new bid is mined (6622ms)

  NFTPotionAuction
    Owner Cases
      Whitelist Bidders
        ✓ Whitelist before very first batch (236ms)
        ✓ Whitelist after very first batch (121ms)
        ✓ Whitelist after selling some tokens in normal auction (2026ms)
      Transfer Funds
        ✓ Transfer funds after very first auction (2059ms)
        ✓ Transfer funds after first auction and after second auction (6986ms)
        ✓ Transfer funds only after 3 successful auctions (6471ms)

  NFTPotionAuction
    User Refunds
      ✓ Several batches, claim refunds before new batch starts (6629ms)
      ✓ Several batches, claim refunds after new batch starts (6408ms)
      ✓ Several batches, claim some refunds before, during and after batch (11651ms)

  NFTPotionAuction
    Edge Cases
      Rebidding
        ✓ With same number of tokens, different price (3945ms)
        ✓ With different number of tokens, same price (3941ms)
      Purchase
        ✓ 1 Batch, 600 tokens, 6 purchasers buy all tokens (289ms)
        ✓ 3 Batches, 1440,4624,10350 tokens, several purchasers buy all tokens (2635ms)
        ✓ 3 Batches, 1440,4624,10350 tokens, 1 purchaser buy all tokens (711ms)
      Misc
        ✓ Calling transferFunds before bidders have claimed their tokens (2890ms)
        ✓ All bids are cancelled before new bid can be mined (2727ms)
        ✓ Minimum price equal to direct purchase price (652ms)
        ✓ End Batch pagination (2213ms)
        ✓ Call whitelistBidders with empty arrays (100ms)

  NFTPotionAuction
    Full Auction (Random Seed = 8698777449603351)
        [Batch 1/2]
           [Round 1/3]: 100%                   
           [Round 2/3]: 100%                   
           [Round 3/3]: 100%                   
        [Batch 2/2]
           [Round 1/3]: 100%                   
           [Round 2/3]: 100%                                 
           [Round 3/3]: 100%                   
      ✓ 3 Batches, 3000, 7000 tokens, 1000 bidders, random distribution (126953ms)


  64 passing (4m)

---------------------------|----------|----------|----------|----------|----------------|
File                       |  % Stmts | % Branch |  % Funcs |  % Lines |Uncovered Lines |
---------------------------|----------|----------|----------|----------|----------------|
 contracts/                |      100 |      100 |      100 |      100 |                |
  INFTPotion.sol           |      100 |      100 |      100 |      100 |                |
  INFTPotionValidator.sol  |      100 |      100 |      100 |      100 |                |
  INFTPotionWhitelist.sol  |      100 |      100 |      100 |      100 |                |
  NFTPotionAuction.sol     |      100 |      100 |      100 |      100 |                |
  RarityConfigItem.sol     |      100 |      100 |      100 |      100 |                |
 contracts/utils/          |    97.62 |    92.86 |      100 |    97.78 |                |
  StructuredLinkedList.sol |    97.62 |    92.86 |      100 |    97.78 |            228 |
---------------------------|----------|----------|----------|----------|----------------|
All files                  |    99.48 |    98.65 |      100 |     99.5 |                |
---------------------------|----------|----------|----------|----------|----------------|

> Istanbul reports written to ./coverage/ and ./coverage.json